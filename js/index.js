$(function(){function t(t,a){$(".captcha").append('<img src="'+t+'">').find("input").val(a)}function a(t,a){$(".form-memory .captcha > img").attr("src",t),$(".form-memory .captcha > input").val(a)}$.get("http://zheny-memory.underoot.ru/captcha",function(a){t(a.image,a.uid)}),$("#update_captcha").click(function(){$.get("http://zheny-memory.underoot.ru/captcha",function(t){a(t.image,t.uid)})}),$("#submit").click(function(){$.ajax("http://zheny-memory.underoot.ru",{type:"PUT",data:$(".form-memory").serialize()}).fail(function(t){var s=t.responseJSON;switch(a(s.image,s.uid),$('.row-captcha input[name="captcha"]').val(""),t.status){case 403:$(".form-memory").append(new String('<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Закрыть</span></button><strong>Код с картинки введен неверно!</strong></div>'));break;case 404:$(".form-memory").append(new String('<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Закрыть</span></button><strong>Превышен тайм-аут запроса!</strong></div>'));break;case 500:$(".form-memory").append(new String('<div class="alert alert-danger alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Закрыть</span></button><strong>Ошибка на сервере!</strong> Попробуйте повторить запрос позднее!</div>'))}}).done(function(){$(".form-memory").hide().html(new String('<div class="alert alert-success alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Закрыть</span></button><strong>Сообщение отправлено!</strong> После проверки администратором ваше воспоминание появится здесь!</div>')).show()})})});